<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Screenshot Taker Web Component</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        /* Custom styling for the web component */
        screenshot-taker {
            display: block;
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border-radius: 12px; /* Custom rounded corners */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .screenshot-button {
            background-color: #28a745; /* Bootstrap success green */
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px; /* Custom rounded corners */
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .screenshot-button:hover {
            background-color: #218838; /* Darker green on hover */
            transform: translateY(-2px);
        }

        .screenshot-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .loading-indicator {
            margin-top: 15px;
            font-size: 14px;
            color: #555;
        }

        .preview-image {
            max-width: 100%;
            height: auto;
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 8px; /* Custom rounded corners */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

    <h1 class="text-center mb-4 text-dark">Web Component Screenshot Demo</h1>

    <div id="fulldiv" class="bg-info-subtle p-4 rounded-3 shadow-sm mb-4 w-100" style="max-width: 600px;">
        <p class="text-info-emphasis fs-5">
            This is some sample content on the page that will be captured by the screenshot component.
            You can add more elements, images, or text here to see how `html2canvas` renders them.
        </p>
        <img src="https://placehold.co/300x150/FF6347/FFFFFF?text=Sample+Image" alt="Placeholder Image" class="mt-3 rounded shadow-sm mx-auto d-block">
        <ul class="mt-3 text-info-emphasis">
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
            <li>Item 1</li>
            <li>Item 2</li>
            <li>Item 3</li>
        </ul>
    </div>

    <!-- The custom web component -->
    <screenshot-taker></screenshot-taker>

    <!-- html2canvas library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Bootstrap JS (Popper.js and Bootstrap bundle) -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" xintegrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" xintegrity="sha384-0pUGZvbkm6XF6gxjEnlco4jJ8yuWwIH72ObQ5oB5FdcfghgjrGC2gxijgSSw" crossorigin="anonymous"></script>

    <script>
        class ScreenshotTaker extends HTMLElement {
            constructor() {
                super();
                // Create a shadow root for encapsulation
                this.attachShadow({ mode: 'open' });
                this.innerHTML = `
                    <button id="takeScreenshotBtn" class="btn btn-success">Take Screenshot</button>
                    <div id="loadingIndicator" class="loading-indicator" style="display: none;">Capturing screenshot...</div>
                    <div id="messageBox" class="message-box"></div>
                    <div id="previewContainer" class="preview-container" style="display: none;">
                        <h3 class="fs-5 fw-semibold mb-3 text-secondary">Screenshot Preview:</h3>
                        <img id="screenshotPreview" class="preview-image" alt="Screenshot Preview">
                        <p class="text-sm text-muted mt-2">Right-click or long-press the image to save it.</p>
                    </div>
                `;

                this.takeScreenshotBtn = this.getElementById('takeScreenshotBtn');
                this.loadingIndicator = this.getElementById('loadingIndicator');
                this.screenshotPreview = this.getElementById('screenshotPreview');
                this.previewContainer = this.getElementById('previewContainer');
                this.messageBox = this.getElementById('messageBox');

                this.takeScreenshotBtn.addEventListener('click', this.takeScreenshot.bind(this));
            }

            showMessage(message, type = 'info') {
                this.messageBox.textContent = message;
                // Bootstrap alert classes are used here for styling
                this.messageBox.className = `message-box show ${type}`;
                setTimeout(() => {
                    this.messageBox.classList.remove('show');
                }, 5000); // Hide after 5 seconds
            }

            async takeScreenshot() {
                this.loadingIndicator.style.display = 'block';
                this.takeScreenshotBtn.disabled = true;
                this.previewContainer.style.display = 'none';
                this.screenshotPreview.src = ''; // Clear previous preview

                try {
                    // Capture the entire body of the document
                    const canvas = await html2canvas(document.getElementById("fulldiv"), {
                        useCORS: true, // Important for handling images from different origins
                        logging: true, // Enable logging for debugging
                        // You can specify a target element instead of document.body:
                        // element: document.querySelector('#target-element-id')
                    });

                    const imgData = canvas.toDataURL('image/png'); // Get image data as PNG

                    // Display the preview
                    this.screenshotPreview.src = imgData;
                    this.previewContainer.style.display = 'block';

                    this.showMessage('Screenshot captured successfully! Right-click the image to save.', 'success');

                } catch (error) {
                    console.error('Error taking screenshot:', error);
                    this.showMessage('Failed to capture screenshot. Please try again.', 'error');
                } finally {
                    this.loadingIndicator.style.display = 'none';
                    this.takeScreenshotBtn.disabled = false;
                }
            }
        }

        // Define the custom element
        customElements.define('screenshot-taker1', ScreenshotTaker);

                class ScreenshotTaker extends HTMLElement {
            constructor() {
                super();
                // Create a shadow root for encapsulation
                this.attachShadow({ mode: 'open' });
                this.shadowRoot.innerHTML = `
                    <style>
                        :host {
                            display: block;
                            padding: 20px;
                            background-color: white;
                            border-radius: 12px; /* Custom rounded corners */
                            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                            max-width: 600px;
                            width: 100%;
                            text-align: center;
                            box-sizing: border-box; /* Ensure padding is included in width */
                        }

                        button {
                            background-color: #28a745; /* Bootstrap success green */
                            color: white;
                            padding: 12px 24px;
                            border: none;
                            border-radius: 8px; /* Custom rounded corners */
                            cursor: pointer;
                            font-size: 16px;
                            transition: background-color 0.3s ease, transform 0.2s ease;
                            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
                        }

                        button:hover {
                            background-color: #218838; /* Darker green on hover */
                            transform: translateY(-2px);
                        }

                        button:active {
                            transform: translateY(0);
                            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                        }

                        .loading-indicator {
                            margin-top: 15px;
                            font-size: 14px;
                            color: #555;
                        }

                        .preview-container {
                            margin-top: 20px;
                            border-top: 1px solid #eee;
                            padding-top: 20px;
                        }

                        .preview-image {
                            max-width: 100%;
                            height: auto;
                            border: 1px solid #ddd;
                            border-radius: 8px; /* Custom rounded corners */
                            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                        }

                        .message-box {
                            background-color: #fff3cd; /* Bootstrap warning light */
                            color: #664d03; /* Bootstrap warning dark */
                            padding: 10px 15px;
                            border-radius: 8px;
                            margin-top: 15px;
                            font-size: 14px;
                            border: 1px solid #ffecb5;
                            display: none; /* Hidden by default */
                        }

                        .message-box.show {
                            display: block;
                        }

                        /* Specific styles for message box types */
                        .message-box.success {
                            background-color: #d4edda; /* Bootstrap success light */
                            color: #155724; /* Bootstrap success dark */
                            border-color: #c3e6cb;
                        }

                        .message-box.error {
                            background-color: #f8d7da; /* Bootstrap danger light */
                            color: #721c24; /* Bootstrap danger dark */
                            border-color: #f5c6cb;
                        }
                    </style>
                    <button id="takeScreenshotBtn" class="btn btn-success">Take Screenshot</button>
                    <div id="loadingIndicator" class="loading-indicator" style="display: none;">Capturing screenshot...</div>
                    <div id="messageBox" class="message-box"></div>
                    <div id="previewContainer" class="preview-container" style="display: none;">
                        <h3 class="fs-5 fw-semibold mb-3 text-secondary">Screenshot Preview:</h3>
                        <img id="screenshotPreview" class="preview-image" alt="Screenshot Preview">
                        <p class="text-sm text-muted mt-2">Right-click or long-press the image to save it.</p>
                    </div>
                `;

                this.takeScreenshotBtn = this.shadowRoot.getElementById('takeScreenshotBtn');
                this.loadingIndicator = this.shadowRoot.getElementById('loadingIndicator');
                this.screenshotPreview = this.shadowRoot.getElementById('screenshotPreview');
                this.previewContainer = this.shadowRoot.getElementById('previewContainer');
                this.messageBox = this.shadowRoot.getElementById('messageBox');

                this.takeScreenshotBtn.addEventListener('click', this.takeScreenshot.bind(this));
            }

            showMessage(message, type = 'info') {
                this.messageBox.textContent = message;
                // Bootstrap alert classes are used here for styling
                this.messageBox.className = `message-box show ${type}`;
                setTimeout(() => {
                    this.messageBox.classList.remove('show');
                }, 5000); // Hide after 5 seconds
            }

            async takeScreenshot() {
                this.loadingIndicator.style.display = 'block';
                this.takeScreenshotBtn.disabled = true;
                this.previewContainer.style.display = 'none';
                this.screenshotPreview.src = ''; // Clear previous preview

                try {
                    // Capture the entire body of the document
                    const canvas = await html2canvas(document.getElementById("fulldiv"), {
                        useCORS: true, // Important for handling images from different origins
                        logging: true, // Enable logging for debugging
                        // You can specify a target element instead of document.body:
                        // element: document.querySelector('#target-element-id')
                    });

                    const imgData = canvas.toDataURL('image/png'); // Get image data as PNG

                    // Display the preview
                    this.screenshotPreview.src = imgData;
                    this.previewContainer.style.display = 'block';

                    this.showMessage('Screenshot captured successfully! Right-click the image to save.', 'success');

                } catch (error) {
                    console.error('Error taking screenshot:', error);
                    this.showMessage('Failed to capture screenshot. Please try again.', 'error');
                } finally {
                    this.loadingIndicator.style.display = 'none';
                    this.takeScreenshotBtn.disabled = false;
                }
            }
        }

        // Define the custom element
        customElements.define('screenshot-taker1', ScreenshotTaker);

    </script>

</body>
</html>


